<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Photo App - Login Required</title>
<style>
  body { margin:0; font-family:Arial,sans-serif; background:#f9f9f9; }
  .page { display:none; height:calc(100vh - 60px); overflow:auto; }
  .active { display:block; }
  .navbar {
    position:fixed; bottom:0; left:0; right:0;
    height:60px; display:flex; justify-content:space-around; align-items:center;
    background:#fff; border-top:1px solid #ccc;
  }
  .navbar button { background:none; border:none; font-size:20px; cursor:pointer; }

  /* Login page */
  #login-page { display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh; }
  #login-page input { margin:5px; padding:8px; width:200px; }
  #login-page button { margin:5px; padding:8px; }
</style>
</head>
<body>

<!-- Login page -->
<div id="login-page">
  <h2>Login to use the app</h2>
  <button id="google-login">Login with Google</button>
  <h3>Or Email/Password</h3>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button id="signup">Sign Up</button>
  <button id="email-login">Login</button>
</div>

<!-- App -->
<div id="app" style="display:none;">
  <div id="page1" class="page active"><h2>My Posts</h2><div id="myposts"></div></div>
  <div id="page2" class="page"><h2>Camera</h2></div>
  <div id="page3" class="page"><h2>Feed</h2><div id="feed"></div></div>
  <div class="navbar">
    <button onclick="showPage(1)">ðŸ‘¤</button>
    <button onclick="showPage(2)">ðŸ“·</button>
    <button onclick="showPage(3)">ðŸ“°</button>
    <button id="logout">ðŸšª</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyA-lNZ4RQS7Xpu2_vzBPCBaBsi_0TlL8dk",
  authDomain: "appp-5f90c.firebaseapp.com",
  projectId: "appp-5f90c",
  storageBucket: "appp-5f90c.appspot.com",
  messagingSenderId: "215310083943",
  appId: "1:215310083943:web:7869ceb90a03567558b1c2",
  measurementId: "G-JJQCFT3PQ9"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

const loginPage = document.getElementById('login-page');
const appDiv = document.getElementById('app');

document.getElementById('google-login').onclick = async () => {
  const provider = new GoogleAuthProvider();
  await signInWithPopup(auth, provider);
};
document.getElementById('signup').onclick = async () => {
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  await createUserWithEmailAndPassword(auth,email,password);
};
document.getElementById('email-login').onclick = async () => {
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  await signInWithEmailAndPassword(auth,email,password);
};
document.getElementById('logout').onclick = () => signOut(auth);

let currentUser = null;
onAuthStateChanged(auth, user => {
  currentUser = user;
  if(user){
    loginPage.style.display='none';
    appDiv.style.display='block';
  } else {
    // Force login if not signed in
    loginPage.style.display='flex';
    appDiv.style.display='none';
    alert("Please log in to use the app");
  }
});

// Simple navigation
const pages = [document.getElementById('page1'),document.getElementById('page2'),document.getElementById('page3')];
window.showPage = function(n){
  if(!currentUser){ alert("You must log in first"); return; }
  pages.forEach((p,i)=> p.classList.toggle('active', i===n-1));
};
</script>
</body>
</html>
